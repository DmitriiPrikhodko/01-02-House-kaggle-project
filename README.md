# 01-02-House-kaggle-project

Kaqqle based - https://www.kaggle.com/competitions/house-prices-advanced-regression-techniques/overview

### Участники проекта:
* Дмитрий Приходько
* Марат Алекберов
* Ахмед Хулаев
* Надежда Ишпайкина

### Описание проекта
В распоряжение предоставляется набор данных по жилым домам в городе Эймс (Айова), включающий 79 признаков, отражающих практически все аспекты характеристик недвижимости. Необходимо построить предиктивную ML модель, способную предсказать конечную стоимость дома (USD) на основании этих признаков. 

### Задачи
* Разработка и внедрение новых признаков, для повышения информативности исходных данных.
* Применение современных ансамблевых методов регрессии, включая модели случайного леса и градиентного бустинга, для повышения точности предсказаний.

По заданию оценка качества моделей проводится с использованием метрики (log) RMSE. Логорифмирование позволяет уравновесить вклад ошибок при прогнозировании как дорогих, так и недорогих домов, делая метрику чувствительной к относительным отклонениям, а не к абсолютным значениям.

## Предобработка:
Первичный анализ данных показал, что целевая переменная SalePrice в целом имеет близкое к нормальному распределение, однако наблюдаются значительные выбросы: около 10% объектов превышают 95-й перцентиль, что указывает на наличие экстремально дорогих домов.

<img width="565" height="425" alt="image" src="https://github.com/user-attachments/assets/93d267d6-4618-46fc-95a6-0cae654553e7" />

Часть категориальных признаков закодирована числовыми значениями, что потребовало дополнительной обработки.
	
#### Заполнение пропущенных значений
Для числовых признаков, содержащих пропуски, была применена стратегия импутации с использованием медианы. Для категориальных строковых признаков пропуски были заполнены строковым значением 'no', для числовых категориальных - значением 0.

#### Удаление признаков
На основании анализа матрицы корреляций, результатов F-теста и метода Shap было принято решение исключить 37 признаков, демонстрирующих низкую корреляцию с целевой переменной и/или значительную мультиколлинеарность с другими признаками.

		["PoolArea", "PoolQC", "Fence", "MiscFeature", "MasVnrType", "Alley", "OverallCond", "GarageQual", "GarageCond", "LandContour", "MSSubClass", "SaleType", "LowQualFinSF", "LandSlope", "MiscVal", "Utilities", "GarageArea", "BsmtFullBath", "BsmtHalfBath", "FullBath", "HalfBath", "TotalBsmtSF", "1stFlrSF", "2ndFlrSF", "GarageType", "GarageYrBlt", "GarageFinish", "GarageArea", "GarageQual", "GarageCond", "GrLivArea", "BsmtFinSF1", "BsmtFinSF2", "TotRmsAbvGrd", "BedroomAbvGr", "YrSold", "YearBuilt"]

<div style="display: flex; align-items: flex-start; gap: 20px;">
  <img width="550" height="550" alt="image2" src="https://github.com/user-attachments/assets/224493cf-7bd9-4fae-a8e3-10579cc837cf" />
  <img width="380" height="450" alt="image1" src="https://github.com/user-attachments/assets/226f281e-663b-42d7-af54-d94787d58fbe" />
</div>

#### Scaling
Для нормализации числовых признаков опробовали StandardScaler, RobustScaler. В оптимальной конфигурации использовался StandardScaler. 
	
#### Encoding
Для кодирования категориальных признаков исползовались CatBoostEncoder, OrdinalEncoder. В некоторых вариациях с моделью CatBoost encoder не использовался, т.к. в отличие от традиционных моделей, CatBoost автоматически обрабатывает категориальные признаки во время обучения.

#### Добавлены новые признаки:
		TotalBsmtBath - общая площадь подвального помещения    
		TotalBath     - общее количество ванных комнат
		TotalSquare   - общая площадь (площадь подвала, 1-го и 2-го этажа)
		GarageAgeYrs  - возраст гаража (лет)
		TotalLivArea  - общая жилая площадь
		TotalRooms"]  - количество комнат
		Age           - возврат дома (лет) 
		RemodelAge    - свежесть ремонта (лет)
  
#### Выбор модели
Из рассмотренных моделей LightGBM, XGBoost, CatBoost, RandomFordest наилучшие резульаты показала модель CatBoost.

| Метрика       | Train            | Valid           |
|---------------|-----------------|----------------|
| MAE           | 0.04717         | 0.08868        |
| MSE           | 0.00430         | 0.01827        |
| R²            | 0.97178         | 0.90210        |

Лучший результат на kaggle: RMSE = 0.13857

<img width="970" height="601" alt="image" src="https://github.com/user-attachments/assets/25fedff4-17ba-4532-8539-ebdbf66affbb" />

